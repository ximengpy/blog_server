{"remainingRequest":"D:\\study\\project\\blogadmin\\client\\node_modules\\babel-loader\\lib\\index.js!D:\\study\\project\\blogadmin\\server\\routes\\article\\index.js","dependencies":[{"path":"D:\\study\\project\\blogadmin\\server\\routes\\article\\index.js","mtime":1593963816742},{"path":"D:\\study\\project\\blogadmin\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\study\\project\\blogadmin\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQiKTsKCnZhciBleHByZXNzID0gcmVxdWlyZSgiZXhwcmVzcyIpOwoKdmFyIGFydGljbGVEQiA9IHJlcXVpcmUoIi4uLy4uL2RiL2FydGljbGUiKTsKCnZhciBhcnRpY2xlSW5mb0RCID0gcmVxdWlyZSgiLi4vLi4vZGIvYXJ0aWNsZUluZm8iKTsKCnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpOwovKuaWh+eroOWPkeihqCovCgpyb3V0ZXIucG9zdCgiL2FkZCIsIGZ1bmN0aW9uIChyZXEsIHJlcykgewogIHZhciBfcmVxJGJvZHkgPSByZXEuYm9keSwKICAgICAgdHlwZSA9IF9yZXEkYm9keS50eXBlLAogICAgICB0aXRsZSA9IF9yZXEkYm9keS50aXRsZSwKICAgICAgdGFnID0gX3JlcSRib2R5LnRhZywKICAgICAgY29udGVudCA9IF9yZXEkYm9keS5jb250ZW50LAogICAgICBzdXJmYWNlID0gX3JlcSRib2R5LnN1cmZhY2U7IC8v5ZCO56uv5pWw5o2u6aqM6K+BCgogIGlmICghdHlwZSB8fCAhdGl0bGUgfHwgIXRhZyB8fCAhY29udGVudCkgewogICAgcmVzLnNlbmQoewogICAgICBjb2RlOiAxLAogICAgICBtc2c6ICLmlbDmja7kuI3lrozmlbQiCiAgICB9KTsKICAgIHJldHVybjsKICB9CiAgLyrmlbDmja7lupPlrZjlgqgqLwoKCiAgYXJ0aWNsZURCLmNyZWF0ZShzdXJmYWNlID8gewogICAgdHlwZTogdHlwZSwKICAgIHRpdGxlOiB0aXRsZSwKICAgIHRhZzogdGFnLAogICAgY29udGVudDogY29udGVudCwKICAgIHN1cmZhY2U6IHN1cmZhY2UKICB9IDogewogICAgdHlwZTogdHlwZSwKICAgIHRpdGxlOiB0aXRsZSwKICAgIHRhZzogdGFnLAogICAgY29udGVudDogY29udGVudAogIH0pLnRoZW4oZnVuY3Rpb24gKGQpIHsKICAgIHJlcy5zZW5kKHsKICAgICAgY29kZTogMCwKICAgICAgbXNnOiAi5Y+R6KGo5oiQ5YqfIgogICAgfSk7CiAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgcmVzLnNlbmQoewogICAgICBjb2RlOiA0LAogICAgICBtc2c6ICLlj5HooajlpLHotKXvvIzor7fnqI3lkI7lho3or5UiCiAgICB9KTsKICB9KTsKfSk7Ci8q5paH56ug6I635Y+WKi8KCnJvdXRlci5nZXQoIi9nZXQiLCBmdW5jdGlvbiAocmVxLCByZXMpIHsKICB2YXIgX3JlcSRxdWVyeSA9IHJlcS5xdWVyeSwKICAgICAgc2tpcCA9IF9yZXEkcXVlcnkuc2tpcCwKICAgICAgbGltaXQgPSBfcmVxJHF1ZXJ5LmxpbWl0OwogIGFydGljbGVEQi5maW5kKHt9LCB7fSwgewogICAgc2tpcDogc2tpcCAqIDEsCiAgICBsaW1pdDogbGltaXQgKiAxCiAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgcmVzLnNlbmQoewogICAgICBjb2RlOiAwLAogICAgICBtc2c6ICLmn6Xmib7miJDlip8iLAogICAgICBkYXRhOiBkYXRhCiAgICB9KTsKICB9KS5jYXRjaChmdW5jdGlvbiAocikgewogICAgY29uc29sZS5sb2cocik7CiAgICByZXMuc2VuZCh7CiAgICAgIGNvZGU6IDQsCiAgICAgIG1zZzogIuacjeWKoeWZqOmUmeivryIsCiAgICAgIGRhdGE6IFtdCiAgICB9KTsKICB9KTsKfSk7Ci8q5paH56ug5Yig6ZmkKi8KCnJvdXRlci5wb3N0KCIvZGVsZXRlIiwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgdmFyIF9pZCA9IHJlcS5ib2R5Ll9pZDsKICAvKuWIoCovCgogIGFydGljbGVEQi5yZW1vdmUoewogICAgX2lkOiBfaWQKICB9KS50aGVuKGZ1bmN0aW9uIChuKSB7CiAgICByZXMuc2VuZCh7CiAgICAgIGNvZGU6IDAsCiAgICAgIG1zZzogIuWIoOmZpOaIkOWKnyIKICAgIH0pOwogIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICByZXMuc2VuZCh7CiAgICAgIGNvZGU6IDQsCiAgICAgIG1zZzogIuacjeWKoeWZqOmUmeivryIKICAgIH0pOwogIH0pOwp9KTsKLyrmlofnq6Dmm7TmlrAqLwoKcm91dGVyLnBvc3QoIi91cGRhdGUiLCBmdW5jdGlvbiAocmVxLCByZXMpIHsKICB2YXIgX3JlcSRib2R5MiA9IHJlcS5ib2R5LAogICAgICBfaWQgPSBfcmVxJGJvZHkyLl9pZCwKICAgICAgb3B0aW9ucyA9IF9yZXEkYm9keTIub3B0aW9uczsKICAvKuabtOaWsCovCgogIGFydGljbGVEQi51cGRhdGVPbmUoewogICAgX2lkOiBfaWQKICB9LCBvcHRpb25zKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgIHJlcy5zZW5kKHsKICAgICAgY29kZTogMCwKICAgICAgbXNnOiAi5pu05paw5oiQ5YqfIgogICAgfSk7CiAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgcmVzLnNlbmQoewogICAgICBjb2RlOiA0LAogICAgICBtc2c6ICLmm7TmlrDlpLHotKXvvIzmnI3liqHlmajplJnor68iCiAgICB9KTsKICB9KTsKfSk7Ci8q5paH56ug5L+h5oGv6I635Y+WKi8KCnJvdXRlci5nZXQoIi9nZXRJbmZvIiwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgYXJ0aWNsZUluZm9EQi5maW5kT25lKHt9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICByZXMuc2VuZCh7CiAgICAgIGNvZGU6IDAsCiAgICAgIG1zZzogIuivt+axguaIkOWKnyIsCiAgICAgIGRhdGE6IGRhdGEKICAgIH0pOwogIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgIHJlcy5zZW5kKHsKICAgICAgY29kZTogNCwKICAgICAgbXNnOiAi5pyN5Yqh5Zmo6ZSZ6K+vIiwKICAgICAgZGF0YTogewogICAgICAgIHRhZ3M6IFtdLAogICAgICAgIG51bTogMAogICAgICB9CiAgICB9KTsKICB9KTsKfSk7Cm1vZHVsZS5leHBvcnRzID0gcm91dGVyOw=="},{"version":3,"sources":["D:/study/project/blogadmin/server/routes/article/index.js"],"names":["express","require","articleDB","articleInfoDB","router","Router","post","req","res","body","type","title","tag","content","surface","send","code","msg","create","then","d","catch","get","query","skip","limit","find","data","r","console","log","_id","remove","n","e","options","updateOne","findOne","tags","num","module","exports"],"mappings":"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","sourcesContent":["\r\nconst express = require(\"express\");\r\nconst articleDB = require(\"../../db/article\");\r\nconst articleInfoDB = require(\"../../db/articleInfo\");\r\n\r\nlet router = express.Router();\r\n\r\n/*文章发表*/\r\nrouter.post(\"/add\",(req,res)=>{\r\n  let {type,title,tag,content,surface} = req.body;\r\n  //后端数据验证\r\n  if (!type||!title||!tag||!content){\r\n    res.send({\r\n      code : 1,\r\n      msg : \"数据不完整\",\r\n    });\r\n    return;\r\n  }\r\n\r\n  /*数据库存储*/\r\n  articleDB.create(\r\n    surface?{type,title,tag,content,surface}:{type,title,tag,content}\r\n  ).then(d=>{\r\n    res.send({\r\n      code : 0,\r\n      msg : \"发表成功\"\r\n    })\r\n  }).catch(()=>{\r\n    res.send({\r\n      code : 4,\r\n      msg : \"发表失败，请稍后再试\"\r\n    })\r\n  })\r\n\r\n});\r\n\r\n/*文章获取*/\r\nrouter.get(\"/get\",(req,res)=>{\r\n  let {skip,limit} = req.query;\r\n\r\n  articleDB.find({},{},{skip:skip*1,limit:limit*1})\r\n    .then(data=>{\r\n      res.send({\r\n        code : 0,\r\n        msg : \"查找成功\",\r\n        data\r\n      });\r\n    })\r\n    .catch(r=>{\r\n      console.log(r);\r\n      res.send({\r\n        code : 4,\r\n        msg : \"服务器错误\",\r\n        data : []\r\n      })\r\n    })\r\n});\r\n\r\n/*文章删除*/\r\nrouter.post(\"/delete\",(req,res)=>{\r\n  let {_id} = req.body;\r\n\r\n  /*删*/\r\n  articleDB.remove({_id})\r\n    .then(n=>{\r\n      res.send({\r\n        code : 0,\r\n        msg : \"删除成功\"\r\n      });\r\n    })\r\n    .catch(e=>{\r\n      res.send({\r\n        code : 4,\r\n        msg : \"服务器错误\"\r\n      });\r\n    })\r\n});\r\n\r\n/*文章更新*/\r\nrouter.post(\"/update\",(req,res)=>{\r\n  let {_id,options} = req.body;\r\n  /*更新*/\r\n  articleDB.updateOne({_id},options)\r\n    .then(()=>{\r\n      res.send({\r\n        code : 0,\r\n        msg : \"更新成功\"\r\n      })\r\n    })\r\n    .catch(()=>{\r\n      res.send({\r\n        code : 4,\r\n        msg : \"更新失败，服务器错误\"\r\n      })\r\n    })\r\n});\r\n\r\n/*文章信息获取*/\r\nrouter.get(\"/getInfo\",(req,res)=>{\r\n  articleInfoDB.findOne({})\r\n    .then(data=>{\r\n      res.send({\r\n        code : 0,\r\n        msg : \"请求成功\",\r\n        data\r\n      });\r\n    })\r\n    .catch(()=>{\r\n      res.send({\r\n        code : 4,\r\n        msg : \"服务器错误\",\r\n        data : {tags:[],num:0}\r\n      });\r\n    })\r\n});\r\n\r\nmodule.exports = router;\r\n"]}]}